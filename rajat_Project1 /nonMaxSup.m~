function M = nonMaxSup(Mag, Ori)
%%  Description
%       compute the local minimal along the gradient.
%%  Input: 
%         Mag = (H, W), double matrix, the magnitude of derivative 
%         Ori = (H, W), double matrix, the orientation of derivative
%%  Output:
%         M = (H, W), logic matrix, the edge map
%
%% ****YOU CODE STARTS HERE**** 
[H,W] = size(Mag);

%set up meshgrid
[x,y] = meshgrid(1:W,1:H);

%Get the orientation in the negative directions of the pixels 
%NegOri = Ori + 3.141592;

threshold = 0.2;

%Get the pixel coordinates in the positive and negative directions 
x_positive = x + cos(Ori).*threshold;
y_positive = y + sin(Ori).*threshold;

x_negative = x - cos(Ori).*threshold; 
y_negative = y - sin(Ori).*threshold;

%Get the interpolated pixel intensities for virtual pixels 
VqPositive = interp2(x,y,Mag,x_positive,y_positive);
VqNegative = interp2(x,y,Mag,x_negative,y_negative);

%M = Mag((VqPositive < Mag) & (VqNegative < Mag));
%M = Mag;

M = (VqPositive < Mag) & (VqNegative < Mag);

M = M .* Mag;

end